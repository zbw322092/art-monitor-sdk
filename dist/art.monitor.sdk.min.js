!function(){"use strict";window.TRACKID=Math.random().toString(36).substr(2,9)+"_"+Date.now();var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function t(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var p=function(e){return e.tagName.toLowerCase().replace(/:/g,"\\:")},u=function(e,t){if(!t)return!1;var n=e.ownerDocument;if(null===n)return!1;var r=n.querySelectorAll(t);return 1===r.length&&r[0]===e},y=function(e,t){var n,r=null!==(n=e.getAttribute("id"))&&""!==n?n.match(/^\d/)?'[id="'+n+'"]':"#"+n:null;if(r)return r;var o=function(t){if(!t.hasAttribute("class"))return null;try{return Array.prototype.slice.call(t.classList).filter(function(e){return/^[a-z_-][a-z\d_-]*$/i.test(e)}).map(function(e){return"."+e}).join("")}catch(e){var n=t.getAttribute("class");return(n=n.trim().replace(/\s+/g," ")).split(" ").map(function(e){return"."+e}).join("")}}(e);if(o&&u(e,o))return o;var i=function(e,t){void 0===t&&(t=["id","class","length"]);var n=e.attributes;if(null===n)return null;var r=[];return Array.prototype.forEach.call(n,function(e){-1<t.indexOf(e.nodeName)||r.push("["+e.nodeName+'="'+e.nodeValue+'"]')}),r.join("")}(e,t);if(i&&u(e,i))return i;if(o&&i&&u(e,o+i))return o+i;var a=p(e);return u(e,a)?a:o&&i&&u(e,o+i+" "+a)?o+i+" "+a:null},n=function(e,t){var n,r;void 0===t&&(t={});var o,i=t.attributesToIgnore,a=void 0===i?["id","class","length"]:i,u=function(e){for(var t,n=[],r=e;t=r,"function"==typeof Element?t instanceof Element:t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName;)n.push(r),r=r.parentElement;return n}(e),c="",s=-1;try{for(var l=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(u),f=l.next();!f.done;f=l.next()){var d=f.value,h=y(d,a);if(s++,h){o=d,c=h;break}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return o===e||u.slice(0,s).forEach(function(e){c=c+" "+p(e)+function(e){var t=0,n=e.parentElement;if(n)for(var r=n.children,o=r.length,i=0;i<o;i++)if(t++,r[i]===e)return":nth-child("+t+")";return null}(e)}),c},a=function(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})},i=function(n,r,o){var i,e=new Promise(function(e,t){(i=n[r].apply(n,o))&&a(i).then(e,t)});return e.request=i,e},e=function(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){return this[n][t]=e}})})},o=function(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return i(this[n],e,arguments)})})};function c(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}var s,l,f,d;function h(e,t){this._cursor=e,this._request=t}function v(e){this._index=e}function m(e){this._store=e}function g(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function b(e,t,n){this._db=e,this.oldVersion=t,this.transaction=n?new g(n):null}function w(e){this._db=e}e(h,"_cursor",["direction","key","primaryKey","value"]),o(h,"_cursor",IDBCursor,["update","delete"]),e(v,"_index",["name","keyPath","multiEntry","unique"]),o(v,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),s=v,l="_index",f=IDBIndex,d=h,["openCursor","openKeyCursor"].forEach(function(r){r in f.prototype&&(s.prototype[r]=function(){return e=this[l],t=d,(n=i(e,r,arguments)).then(function(e){if(e)return new t(e,n.request)});var e,t,n})}),m.prototype.createIndex=function(){return new v(this._store.createIndex.apply(this._store,arguments))},m.prototype.index=function(){return new v(this._store.index.apply(this._store,arguments))},e(m,"_store",["name","keyPath","indexNames","autoIncrement"]),o(m,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),g.prototype.objectStore=function(){return new m(this._tx.objectStore.apply(this._tx,arguments))},e(g,"_tx",["objectStoreNames","mode"]),c(g,"_tx",IDBTransaction,["abort"]),b.prototype.createObjectStore=function(){return new m(this._db.createObjectStore.apply(this._db,arguments))},e(b,"_db",["name","version","objectStoreNames"]),c(b,"_db",IDBDatabase,["deleteObjectStore","close"]),e(w,"_db",["name","version","objectStoreNames"]),c(w,"_db",IDBDatabase,["close"]),w.prototype.transaction=function(){return new g(this._db.transaction.apply(this._db,arguments))},["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(h.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),a(t._request).then(function(e){if(e)return new h(e,t._request)})})})}),["openCursor","openKeyCursor"].forEach(function(i){[m,v].forEach(function(e){i in e.prototype&&(e.prototype[i.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],r=this._store||this._index,o=r[i].apply(r,t.slice(0,-1));o.onsuccess=function(){n(o.result)}})})}),[v,m].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,o=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(o.push(e.value),void 0===n||o.length!==n?e.continue():t(o)):t(o)})})})});var _,E=function(e,t,n){var r=i(indexedDB,"open",[e,t]),o=r.request;return o&&(o.onupgradeneeded=function(e){n&&n(new b(o.result,e.oldVersion,o.transaction))}),r.then(function(e){return new w(e)})},S=function(e,t,n){var o=this;this.get=function(t){return o.dbPromise.then(function(e){return e.transaction(o.objName).objectStore(o.objName).get(t)})},this.set=function(n){return o.dbPromise.then(function(e){var t=e.transaction(o.objName,"readwrite");return t.objectStore(o.objName).put(n),t.complete})},this.delete=function(n){return o.dbPromise.then(function(e){var t=e.transaction(o.objName,"readwrite");return t.objectStore(o.objName).delete(n),t.complete})},this.clear=function(){return o.dbPromise.then(function(e){var t=e.transaction(o.objName,"readwrite");return t.objectStore(o.objName).clear(),t.complete})},this.keys=function(){return o.dbPromise.then(function(e){var t=e.transaction(o.objName),n=[],r=t.objectStore(o.objName);return(r.iterateKeyCursor||r.iterateCursor).call(r,function(e){e&&(n.push(e.key),e.continue())}),t.complete.then(function(){return n})})},this.dbPromise=E(e,1,function(e){e.createObjectStore(t,{keyPath:n,autoIncrement:!0})}),this.objName=t},N=function(){this.timestamp=performance.now(),this.trackId=window.TRACKID},j=function(l){function e(e,t,n,r,o,i,a,u,c){var s=l.call(this)||this;return s.type=e,s.target=t,s.addedNode=n,s.removedNodes=r,s.attributeName=o,s.attributeNamespace=i,s.previousSibling=a,s.nextSibling=u,s.oldValue=c,s}return t(e,l),e}(N),C=new S("qnn-mkt","mutations","id"),x=document.querySelector("body"),K=function(e){return(t=e)instanceof Node&&!(t instanceof Element)?e.parentElement?n(e.parentElement)+", nodeValue: "+e.nodeValue:"":n(e);var t},I=function(e){return e instanceof Node?K(e):JSON.stringify(Array.prototype.map.call(e,function(e){return K(e)}))},O=new MutationObserver(function(e){e.forEach(function(e){var t,n,r,o,i,a,u,c,s,l,f,d,h,p,y,v;"attributes"===e.type&&"style"===e.attributeName&&_||(n=(t=e).type,r=t.target,o=t.addedNodes,i=t.removedNodes,a=t.attributeName,u=t.attributeNamespace,c=t.nextSibling,s=t.previousSibling,l=t.oldValue,f=I(r),d=I(o),h=I(i),p=c?I(c):null,y=s?I(s):null,v=new j(n,f,d,h,a,u,y,p,l),C.set(v).then(function(){console.log("record added")}).catch(function(e){console.log("idb err: ",e)}),console.log(v),"attributes"===n&&"style"===a&&(_=window.setTimeout(function(){window.clearTimeout(_),_=null},1e3)))})});x&&O.observe(x,{attributes:!0,attributeOldValue:!0,childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0});var P,k,D=function(e){return null===e?null:e instanceof Element?n(e):Object.prototype.toString.call(e)},T=function(n){function e(e){var t=n.call(this)||this;return t.type=e.type,t.eventPhase=e.eventPhase,t.currentTarget=D(e.currentTarget),t.target=D(e.target),t}return t(e,n),e}(N),A=function(r){function e(e){var t=r.call(this,e)||this,n=e.detail;return t.detail=n,t}return t(e,r),e}(T),L=function(n){function e(e){var t=n.call(this,e)||this;return t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.clientX=e.clientX,t.clientY=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movementX=e.movementX,t.movementY=e.movementY,t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.pageX=e.pageX,t.pageY=e.pageY,t.relatedTarget=D(e.relatedTarget),t.screenX=e.screenX,t.screenY=e.screenY,t.shiftKey=e.shiftKey,t}return t(e,n),e}(A);["click","dblclick"].forEach(function(e){window.addEventListener(e,function(e){var t=new L(e);console.log("clickLog: ",t)})}),window.addEventListener("scroll",function(e){if(!P){var t=new T(e);console.log("scrollLog: ",t),P=window.setTimeout(function(){P=null},1e3)}}),window.addEventListener("resize",function(e){if(!k){var t=new T(e);console.log("resizeLog: ",t),k=window.setTimeout(function(){k=null},1e3)}});var B=function(n){function e(e){var t=n.call(this,e)||this;return t.altKey=e.altKey,t.code=e.code,t.ctrlKey=e.ctrlKey,t.key=e.key,t.location=e.location,t.metaKey=e.metaKey,t.repeat=e.repeat,t.shiftKey=e.shiftKey,t}return t(e,n),e}(A);["keydown"].forEach(function(e){window.addEventListener(e,function(e){var t=new B(e);console.log("keyboardLog: ",t)})});var V;performance.getEntries();try{new EventTarget,V=!0}catch(e){V=!1}var q=function(){function e(){this.registry={}}return e.prototype.addEventListener=function(e,t,n){void 0===n&&(n=!1),this.getRegistry(e).push(t)},e.prototype.removeEventListener=function(e,t,n){void 0===n&&(n=!1);var r=this.getRegistry(e),o=r.indexOf(t);-1<o&&r.splice(o,1)},e.prototype.dispatchEvent=function(t){return t.target=this,Object.freeze(t),this.getRegistry(t.type).forEach(function(e){return e(t)}),!0},e.prototype.getRegistry=function(e){return this.registry[e]||[]},e}(),X=V?EventTarget:q,Y=function(r){function e(e,t){var n=r.call(this,e)||this;return n.newState=t.newState,n.prevState=t.prevState,n.originalEvent=t.originalEvent,n}return t(e,r),e}(V?Event:function(e){this.type=e}),z="active",R="passive",U="hidden",M="frozen",F="terminated",J=window.safari,W="object"==typeof J&&J.pushNotification,$=["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in self?"pagehide":"unload"],G=function(e){return e.preventDefault(),e.returnValue=!0},H=[[z,R,U,F],[z,R,U,M],[U,R,z],[M,U],[M,z],[M,R]].map(function(e){return e.reduce(function(e,t,n){return e[t]=n,e},{})}),Q=function(){return document.visibilityState===U?U:document.hasFocus()?z:R};!function(n){function e(){var t=n.call(this)||this;t.safariBeforeUnloadTimeout=void 0,t.handleEvents=function(e){switch(W&&window.clearTimeout(t.safariBeforeUnloadTimeout),e.type){case"pageshow":case"resume":t.dispatchChangesIfNeeded(e,Q());break;case"focus":t.dispatchChangesIfNeeded(e,z);break;case"blur":t.currState===z&&t.dispatchChangesIfNeeded(e,Q());break;case"pagehide":case"unload":t.dispatchChangesIfNeeded(e,e.persisted?M:F);break;case"visibilitychange":t.currState!==M&&t.currState!==F&&t.dispatchChangesIfNeeded(e,Q());break;case"freeze":t.dispatchChangesIfNeeded(e,M)}};var e=Q();return t.currState=e,t.unsavedChanges=[],$.forEach(function(e){return window.addEventListener(e,t.handleEvents,!0)}),W&&window.addEventListener("beforeunload",function(e){t.safariBeforeUnloadTimeout=window.setTimeout(function(){e.defaultPrevented||e.returnValue||t.dispatchChangesIfNeeded(e,U)},0)}),t}t(e,n),Object.defineProperty(e.prototype,"State",{get:function(){return this.currState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWasDiscarded",{get:function(){return document.wasDiscarded||!1},enumerable:!0,configurable:!0}),e.prototype.addUnsavedChanges=function(e){-1<this.unsavedChanges.indexOf(e)||(0===this.unsavedChanges.length&&window.addEventListener("beforeunload",G),this.unsavedChanges.push(e))},e.prototype.removeUnsavedChanges=function(e){var t=this.unsavedChanges.indexOf(e);-1<t&&(this.unsavedChanges.splice(t,1),0===this.unsavedChanges.length&&window.removeEventListener("beforeunload",G))},e.prototype.dispatchChangesIfNeeded=function(e,t){if(t!==this.currState)for(var n=function(e,t){for(var n=0,r=H.length;n<r;++n){var o=H[n],i=o[e],a=o[t];if(0<=i&&0<=a&&i<a)return Object.keys(o).slice(i,a+1)}return[]}(this.currState,t),r=0,o=n.length;r<o-1;++r){var i=n[r],a=n[r+1];this.currState=a,this.dispatchEvent(new Y("statechange",{prevState:i,newState:a,originalEvent:e}))}}}(X)}();
